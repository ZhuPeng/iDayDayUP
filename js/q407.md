JavaScript: How do you prevent promises swallowing errors?